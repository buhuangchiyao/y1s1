---
sidebar: auto
---
## 概述

###  操作系统概念
- **定义**：**管理系统资源**、**控制程序执行**、改善人机界面、提供各种服务，并合理组织计算机工作流程和为用户方便有效地使用计算机提供良好运行环境的一种系统软件。


- 计算机系统的**软硬件层次结构**
    
	1. 计算机硬件
	2. 系统软件（**操作系统**）
	3. 支撑软件
	4. 应用软件
	5. 用户

- **作用**
  
    1. 和硬件直接交互，封装硬件的复杂性，并对硬件进行扩充和改造，包括：**资源的调度与分配**、**信息的存取与保护**、**并发活动的协调与控制**。
    2. 和支撑软件和应用软件进行交互，把它们**与硬件隔离**，为程序员**提供方便的编程接口**、有力的功能支撑、良好的运行环境。


###  三大资源管理技术

- **复用**
  - 在**多道程序设计**中，系统中多个进程竞争使用资源，由于计算机系统的物理资源是宝贵和稀有的，操作系统让**众多进程共享物理资源**，这种共享称为**资源复用**。
  - 空分复用共享：表明资源可以从“空间”上分割成更小的单位供进程使用。
  - 时分复用共享：表明资源可以从“时间”上分割成更小的单位供进程使用。

<br/>

- **虚拟**
  - **本质**：对资源进行转化、模拟和整合，把**一个物理资源变成多个逻辑上的对应物**，也可以把**多个物理资源变为单个逻辑上的对应物**。
  - 可以解决**某类物理资源数量**不足的问题，并且能够为应用程序提供易于使用的虚拟资源并创建更好的运行环境。

<br/>

- **抽象**
  - 用于处理**系统的复杂性**，重点解决资源易用性。
  - 通过创建软件来**屏蔽硬件资源的物理特性和实现细节**，简化对硬件资源的操作、控制和使用，即不考虑物理细节而对资源执行操作的技术。

<br/>

###  四大基本特征

- **并发**
  - 并发：宏观上在一段时间内能同时运行多个程序。
  - 并行：同一时刻能运行多个指令，需要硬件支持，如：多流水线，多核处理器或分布式系统。
  - **操作系统的并发性**：宏观上多道程序同时进行，微观上串行运行
  - 操作系统通过引入进程和线程，实现程序的并发执行。

<br/>

- **共享**
  - 共享是指：系统中的**资源可以被多个进程共同使用**，即**并发活动**共享各种软、硬件资源。
  - 两种共享方式：**同时共享**，**互斥共享**。
  - 互斥共享的资源称为**临界资源**，即同一时刻只允许一个进程访问，需要**同步机制**来实现互斥访问。

<br/>

- **虚拟**
  - 虚拟技术把一个物理实体转换为多个逻辑实体。
  - 两种虚拟技术：**时分复用技术**、**空分复用技术**。
  - **多个进程在同一个处理器上并发执行**使用了时分复用技术，让每个进程轮流占用处理器，每次只执行一小个时间片并快速切换。
  - **虚拟内存**使用了空分复用技术。


<br/>

- **异步**
  - 异步指进程不是一次性执行完毕，而是走走停停，以**不可知的速度向前推进**。

###  操作系统的功能

- **计算机系统资源的管理者**

	- **进程管理**：进程控制、进程同步、进程通信、死锁处理、处理器调度等。
	- **内存管理**：内存分配、地址映射、内存保护和共享、虚拟内存等。
	- **文件管理**：文件存储空间的管理、目录管理、文件读写管理和保护等。
	- **I/O管理**：完成用户的I/O请求，方便用户使用各种设备，并提高设备的利用率。

<br/>

- **用户与计算机系统之间的接口**

	- 命令接口
	- 程序接口
	- GUI


###  用户态和内核态

- 用户态
    - 只能**受限**的访问内存，不允许访问外围设备
    - 其占有的处理机是**可以被抢占的**


- 内核态（管态）
  - 能访问所有的内存空间和对象
  - 其所占有的处理机**不可抢占**

- 用户态向内核态转换的方式
  - **系统调用**：用户进程通过系统调用申请使用**操作系统提供的**服务程序完成工作。
  - **异常**：CPU在**执行用户态下的程序**时，发生了某些实现不可知的异常，会触发**异常处理机制**，转换到内核态。
  - **外围设备中断**：外围设备完成用户的请求后，会向CPU发出相应的中断信号，CPU会执行中断处理程序，转换到内核态。
  

### 中断和异常

- 中断（外中断）——cpu执行指令以外的事件的发生

	- I/O 中断
	- 时钟中断

- 异常（内中断）——CPU执行指令内部的事件

	- 程序非法操作
	- 地址越界
	- 算术溢出

### 问题
1. 为什么要划分用户态和内核态？
   
	由于需要限制不同程序之间的访问能力，防止它们获取别的程序的内存数据，或者获取外围设备的数据。

2.  用户态到内核态的转换原理？

	1. 系统调用：这是用户态进程主动要求切换到内核态的一种方式，用户态进程通过系统调用申请使用操作系统提供的服务程序完成工作。
	2. 异常：当CPU在执行运行在用户态下的程序时，发生了某些事先不可知的异常，这时会触发由当前运行进程切换到处理此异常的内核相关程序中，也就转到了内核态，比如缺页异常。
	3. 外围设备的中断：当外围设备完成用户请求的操作后，会向CPU发出相应的中断信号，这时CPU会暂停执行下一条即将要执行的指令转而去执行与中断信号对应的处理程序，如果先前执行的指令是用户态下的程序，那么这个转换的过程自然也就发生了由用户态到内核态的切换。比如硬盘读写操作完成，系统会切换到硬盘读写的中断处理程序中执行后续操作等。

3. 中断的作用与实现过程？

   **作用**：可以使CPU和外设同时工作，使系统可以及时响应外部事件；可以允许多个外设同时工作，提高CPU利用率；可以使CPU及时处理各种软硬件故障。

   实现过程：关中断；保存断点；引入中断服务程序；保存现场和屏蔽字；开中断；执行中断服务程序；关中断；恢复现场和屏蔽字；开中断。

4. 函数调用和系统调用的区别？

	1. 系统调用：操作系统提供给用户程序调用的一组特殊接口，可以获得系统内核服务；系统调用可以用来控制硬件。系统调用在内核地址空间执行。
	2. 函数调用：运行在用户空间；通过压栈操作进行函数调用；与用户程序相联系，属于过程调用、调用开销较小。

